{% extends 'base.html' %}
{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/game/memory-game.css' %}" />
<link rel="stylesheet" href="{% static 'css/game/game_settings_panel.css' %}" />
{% endblock %}

{% block page_name %}–ü–æ–∏—Å–∫ –ø–∞—Ä{% endblock %}

{% block content %}
<div class="memory-page-wrapper">
    <div id="memory-game-area" class="memory-game-area">
        <div id="memory-game-wrapper" class="memory-game-wrapper">
            <p class="initial-message">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É".</p>
        </div>
    </div>

    <div id="memory-game-settings" class="game-settings-panel"> <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â–∏–π –∫–ª–∞—Å—Å -->
        <div class="settings-content-inner">
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h2>
            <label for="game-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã:</label>
            <input type="text" id="game-name" placeholder="–ú–æ—è –∏–≥—Ä–∞ –≤ –ø–∞—Ä—ã">
            <h3>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–±–æ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫:</h3>
            <div class="presets-container">
                <div class="preset-set" data-set-name="fruits">–§—Ä—É–∫—Ç—ã üçì</div>
                <div class="preset-set" data-set-name="animals">–ñ–∏–≤–æ—Ç–Ω—ã–µ üêº</div>
            </div>
            <label for="custom-images-input" class="upload-label">
                –ò–õ–ò –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
            </label>
            <input type="file" id="custom-images-input" accept="image/*" multiple>
            <div id="custom-images-preview" class="image-preview-container" style="display: none;">
                <p id="custom-images-info-text">–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: <span id="custom-images-count">0</span></p>
                <div class="preview-grid"></div>
            </div>
            <label for="pair-count-select">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä:</label>
            <select id="pair-count-select">
                <option value="2">2 –ø–∞—Ä—ã</option>
                <option value="3">3 –ø–∞—Ä—ã</option>
                <option value="4" selected>4 –ø–∞—Ä—ã</option>
                <option value="5">5 –ø–∞—Ä—ã</option>
                <option value="6">6 –ø–∞—Ä</option> 
            </select>
            <div class="settings-buttons">
                <button id="start-memory-game">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    const isAuthenticated = {% if request.user.is_authenticated %}true{% else %}false{% endif %};
    const loginUrl = "{% url 'login' %}?next=" + window.location.pathname;
    const presetImagesBasePath = "{% static 'images/memory_game_presets/' %}"; 
</script>
<script src="{% static 'js/game/memory_game.bundle.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        if (typeof window.MemoryGameModule !== 'undefined' && typeof window.MemoryGameModule.createMemoryGameSeparately === 'function') {
            window.MemoryGameModule.createMemoryGameSeparately();
        } else {
            console.error("–§—É–Ω–∫—Ü–∏—è createMemoryGameSeparately –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.");
        }
    });
</script>
{% endblock %}